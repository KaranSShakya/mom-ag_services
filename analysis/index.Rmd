---
title: "Home"
site: workflowr::wflow_site
output:
  workflowr::wflow_html:
    toc: true
editor_options:
  chunk_output_type: console
---

Hello! This is a GitHub website I built for your dataset. I will update this page with different visualizations from your data.

```{r eval=T, echo=F, message=F, warning=F}
library(tidyverse)
library(ggthemes)
library(ggrepel)
library(gridExtra)

survey <- read_csv("data/survey.csv")
names(survey)[5] <- "farming"
```

### Average Scatter Plot - Current
Since showing 100 variables on one graph is hard, I divided the ecosystem services into 3 (Provisioning, Cultural, Regulating). I put *supporting* into *provisioning*.
```{r eval=T, echo=F, fig.height=20, fig.width=10}
cur <- survey %>% 
  select(-7,-8,-9)
cur.pa <- cur %>% 
  filter(eco_type=="Provisioning") %>% 
  select(2,6) %>% 
  group_by(eco_ser) %>% 
  summarise(avg_res=mean(current)) %>% 
  ungroup()
cur.ca <- cur %>% 
  filter(eco_type=="Cultural") %>% 
  select(2,6) %>% 
  group_by(eco_ser) %>% 
  summarise(avg_res=mean(current)) %>% 
  ungroup()
cur.ra <- cur %>% 
  filter(eco_type=="Regulating") %>% 
  select(2,6) %>% 
  group_by(eco_ser) %>% 
  summarise(avg_res=mean(current)) %>% 
  ungroup()
a <- ggplot(cur.pa, aes(x=avg_res, y=eco_ser))+
  geom_point(size=1)+
  labs(title="ES-Current : Provisioning", x="Ranking", y="Ecosystem Services")+
  scale_x_continuous(limits = c(1,5))+
  geom_vline(xintercept = 3, color="red")
b <- ggplot(cur.ca, aes(x=avg_res, y=eco_ser))+
  geom_point(size=1)+
  labs(title="ES-Current : Cultural", x="Ranking", y="Ecosystem Services")+
  scale_x_continuous(limits = c(1,5))+
  geom_vline(xintercept = 3, color="red")
c <- ggplot(cur.ra, aes(x=avg_res, y=eco_ser))+
  geom_point(size=1)+
  labs(title="ES-Current : Regulating", x="Ranking", y="Ecosystem Services")+
  scale_x_continuous(limits = c(1,5))+
  geom_vline(xintercept = 3, color="red")
grid.arrange(a,b,c, ncol=1)
```
This is the most general scatterplot of the survey results for current. Since **cultural** and **regulating** do not have any variable that averaged below 3 (satisfactory), we can conclude that most villages are happy or at least satisfied with these ES. However, there are a lot of variables below 3 for **provisional**, which might suggest that we focus on this ES.

***

### Current and Demand - Same Plot
```{r eval=T, echo=F}
cur_dem <- survey %>% 
  select(2,6,7,10) %>% 
  group_by(eco_ser, eco_type) %>% 
  summarize(avg_c=mean(current), avg_d=mean(demand)) %>% 
  ungroup() %>% 
  na.omit()
cur_dem$avg_c <- round(cur_dem$avg_c, 1)

cur_dem$avg_d <- round(cur_dem$avg_d, 0)
cur_dem$avg_d <- factor(cur_dem$avg_d)
levels(cur_dem$avg_d) <- c("decreases", "stays the same", "increases")
```
```{r eval=T, echo=F}
d <- filter(cur_dem, eco_type=="Provisioning") %>% 
  ggplot(aes(x=avg_c, y=eco_ser, color=avg_d))+
  geom_point(shape=15)+
  scale_x_continuous(limits = c(1,5))+
  labs(color="Demand in Future", title="Provisioning",
       x="Current", y="Ecosystem Services")+
  scale_color_manual(values = c("red2", "royalblue", "green3"))

e <- filter(cur_dem, eco_type=="Cultural") %>% 
  ggplot(aes(x=avg_c, y=eco_ser, color=avg_d))+
  geom_point(shape=15)+
  scale_x_continuous(limits = c(1,5))+
  labs(color="Demand in Future", title="Cultural",
       x="Current", y="Ecosystem Services")+
  scale_color_manual(values = c("red2", "royalblue", "green3"))

f <- filter(cur_dem, eco_type=="Regulating") %>% 
  ggplot(aes(x=avg_c, y=eco_ser, color=avg_d))+
  geom_point(shape=15)+
  scale_x_continuous(limits = c(1,5))+
  labs(color="Demand in Future", title="Regulating",
       x="Current", y="Ecosystem Services")+
  scale_color_manual(values = c("red2", "royalblue", "green3"))  

grid.arrange(d,e,f, ncol=1)
```




***
